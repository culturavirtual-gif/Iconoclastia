<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cabeza Adolfo López Mateos</title>

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/aframe-virtual-joystick/dist/aframe-virtual-joystick.js"></script>
    
   <link href="https://fonts.googleapis.com/css2?family=Alex+Brush&display=swap" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css2?family=Caveat+Brush&display=swap" rel="stylesheet">

    <!-- Visor 3D embebido -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

    <script src="js/image-texts.js"></script>
    <script src="js/app.js"></script>
    
    <style>

/* =====================================================================
       1. VARIABLES Y RESETEO BASE
       ---------------------------------------------------------------------
       - Paleta, medidas del carril derecho, alto de miniaturas.
       - Se fuerza box-sizing para evitar desbordes.
       ===================================================================== */
    :root{
      --bg:#0b0d12;
      --fg:#000000; /* fondo */
      --line:#232938;
      --rail:260px;    /* ancho del carril derecho con carrusel */
      --thumbH:120px;  /* alto de miniaturas en el carrusel */
      --gap:12px;      /* separación general entre elementos */
    }
    *, *::before, *::after{ box-sizing:border-box }

html,body{
      height:100%; margin:0;
      background:var(--bg); color:var(--fg);
      font-family:system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

  a-scene {
        display:block;
      }



    #infoOverlay{
      position:fixed; inset:0; z-index:10002;
      background:rgba(0,0,0,.6);
      display:none; /* se muestra al abrir (JS) */
    }

    /* ÚNICA definición de info-content */
  .info-content{
      position:absolute; top:6%; left:6%;
      width:88%; height:88%;
      background:rgba(0,0,0,.515);
      color:#fff; padding:16px; border-radius:12px;
      display:flex; flex-direction:column; gap:var(--gap);
      overflow:hidden;           /* clave: sin scroll global */
      box-shadow:0 10px 30px rgba(0,0,0,.35);
    }

     /* =====================================================================
       5. GRID INTERNO DEL OVERLAY
       ---------------------------------------------------------------------
       - .infogrid divide el overlay en dos columnas: izquierda y carril.
       - min-height:0 es crítico para habilitar scroll en hijos.
       - La columna izquierda (.leftcol) se subdivide en texto y visor.
       ===================================================================== */

  .infogrid{
      flex:1 1 auto; min-height:0;     /* clave */
      display:grid; gap:var(--gap);
      grid-template-columns: minmax(0,1fr) var(--rail);
    }     

  .leftcol{ display:grid; grid-template-rows:auto 1fr; gap:12px; min-height:0 }
    .text-zone{
      overflow:hidden;  /* texto fijo */
      border:1px dashed rgba(255,255,255,.08);
      border-radius:8px; padding:10px;
    }

    /* =====================================================================
        Visor 3D
       ---------------------------------------------------------------------
       4/11/2023: ajustado para model-viewer
       ===================================================================== */ 
    .viewer{
      min-height:240px; height:50vh;
      background:#000000;
      border:1px solid var(--line); border-radius:10px;
      display:grid; place-items:center;
    }
    .viewer small{ opacity:.7 }

    .main-col{display:flex; flex-direction:column; gap:12px; min-height:0}

#ovl-viewer{width:100%; height:100%}

        /* =====================================================================
       6. CARRIL DERECHO + CARRUSEL VERTICAL INDEPENDIENTE
       ---------------------------------------------------------------------
       - Solo la zona .vc-viewport tiene scroll vertical.
       - overscroll-behavior:contain evita que el scroll se propague al overlay.
       ===================================================================== */

  .rail{ min-height:0; border-left:1px solid var(--line); padding-left:8px }
  .vcarousel{
      min-height:0; height:100%;
      display:grid; gap:8px;
      grid-template-rows:auto 1fr auto; /* ▲ [lista] ▼ */
    }
  .vc-nav{ display:flex; gap:8px; align-items:center; justify-content:space-between }
  .vc-btn{
      cursor:pointer; width:100%; padding:8px 10px;
      border-radius:8px; background:#0f1117; color:#e5e7eb;
      border:1px solid var(--line); user-select:none;
    }  

 .vc-viewport{
      min-height:0; height:100%;
      overflow-y:auto;              /* solo vertical */
      overflow-x:hidden;            /* sin horizontal */
      overscroll-behavior:contain;  /* no se arrastra al overlay */
      scroll-snap-type:y mandatory;
      padding-right:4px;
    }
  
  .vc-track{ display:flex; flex-direction:column; gap:10px }
  .vc-item{
      display:block; width:100%; height:var(--thumbH);
      object-fit:cover;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      scroll-snap-align:start;
      cursor:pointer;
    }  

    /* =====================================================================
       7. OVERLAY DE IMAGEN AMPLIADA
       ---------------------------------------------------------------------
       - Se abre al hacer click en una miniatura.
       - Muestra imagen grande y nota al pie (figcaption).
       ===================================================================== */

    #imgOverlay{
      position:fixed; inset:0; z-index:10003;
      background:rgba(0,0,0,.85);
      display:none; align-items:center; justify-content:center;
      padding:20px;
    }

  .imgbox{
      position:relative;
      max-width:min(90vw, 1200px);
      max-height:85vh;
      background:rgba(0,0,0,.9);
      padding:12px; border-radius:12px;
      display:flex; flex-direction:column; gap:8px; align-items:center;
      overflow:hidden; border:1px solid var(--line);
    }

  .imgbox img{ max-width:100%; max-height:calc(85vh - 56px); display:block }
    .imgbox figcaption{ font-size:.92rem; line-height:1.35; color:#ddd; text-align:center }
    .imgbox .close{ position:absolute; top:8px; right:12px }







#pantalla-carga{position:fixed;inset:0;background:url('assets/img/CALM/CALM_04.png') center/cover no-repeat;z-index:9999}
#pantalla-carga .loader{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  width:60px;height:60px;border:8px solid #0c0000;border-top:8px solid #444;
  border-radius:50%;animation:girar 1s linear infinite;
}

#pantalla-carga .loader-logo{position:absolute;top:1rem;right:1rem;width:160px}



      /* Capa negra semitransparente */
      #pantalla-carga::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 0;
      }

      /* Animación de carga */
    /* aro sobre la imagen */
.loader{
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  width:calc(100% + 24px); height:calc(100% + 24px);
  border:8px solid rgba(255,255,255,.25);
  border-top-color:#ffffff;   /* cambia color aquí */
  border-radius:50%;
  animation:girar 1s linear infinite;
  pointer-events:none;
}

      @keyframes girar {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
     
      /* Logo UAEMex   */
     .ui-esquina {
        position: fixed;
        top: 1em;
        right: 1em;
        width: 6.5rem; /* Ajusta el tamaño según tu necesidad */
        z-index: 9999;
      }

        /* Botón Info */
      .info-button {
        position: fixed;
        top: 10px;
        left: 80px;
        padding: 7px 15px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 6px;
        z-index: 10001;
        cursor: pointer;
      }

      /* Capa oscura */
      .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 10000;
      }

      

      /* ===== Overlay con visor + carrusel ===== */

     
      












      .close-button {
        position: fixed;
        top: 10px;
        right: 20px;
        font-size: 20px;
        cursor: pointer;
        font-weight: bold;
}
      #help-button {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 10001;
        padding: 6px 12px;
        background-color: #865905;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      #help-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        z-index: 10002;
        justify-content: center;
        align-items: center;
      }

      #help-overlay img {
        max-width: 90%;
        max-height: auto;
      }

      #close-help {
        position: absolute;
        top: 10px;
        left: 10px;
        background-color: #865905;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

    
    </style>
  </head>


  <body>

<!-- Pantalla de carga -->
<div id="pantalla-carga">
  <div class="loader"></div>
  <!-- opcional -->
  <img class="loader-logo" src="MP_hover1.png" alt="">
</div>



     <img src="logoUAEMex.png" class="ui-esquina" />

      <!-- Botón "Info" -->
    <button class="info-button" onclick="abrirInfo()">Info</button>





    <!-- Overlay de información -->
    <div class="overlay" id="infoOverlay">
         
      
        <div class="info-content">
  <div class="close-button" onclick="cerrarInfo()">✖</div>

  <div class="infogrid">
    <!-- Columna principal: visor arriba, texto abajo -->
    <section class="main-col">
      <!-- Visor 3D -->
      <div class="viewer">
        <!-- Cambia src si quieres otro GLB -->
        <model-viewer id="ovl-viewer"
          src="cabeza.glb"
          camera-controls auto-rotate
          exposure="0.5" shadow-intensity="1"
          ar ar-modes="webxr scene-viewer quick-look"
          alt="Visor 3D">
        </model-viewer>
      </div>

      <!-- Texto debajo del visor -->
      <article class="text-zone" id="ovl-texto">
        <p>
          La Cabeza Silenciada: Iconoclasia y Reescritura del Monumento
En la cima del Cerro de Coatepec, la monumental cabeza de Adolfo López Mateos —erigida en 1972 como símbolo de poder, identidad universitaria y homenaje al expresidente mexiquense— se erige hoy como un cuerpo herido. Su superficie de cantera, fragmentada por el tiempo y por la acción humana, ha dejado de ser un monumento para convertirse en un campo de disputa simbólica.
Durante décadas, esta escultura fue contemplada como emblema de orgullo institucional; sin embargo, las generaciones recientes la han resignificado mediante actos de intervención y confrontación. Pinturas, mantas, cruces, consignas y marcas sobre la boca o el rostro —desde la manta “Edoméx feminicida” de 2020 hasta la equis negra y los golpes del 2025— son gestos que se inscriben en una genealogía iconoclasta: la negación del ídolo como gesto político y el reclamo de voz ante las estructuras que intentan silenciarla.
En este recorrido virtual, la cabeza no se muestra restaurada ni monumental, sino abierta a la interpretación colectiva. Cada capa digital reconstruye su superficie herida, revelando las huellas del conflicto, el dolor y la exigencia de transformación. La piedra se convierte en archivo vivo de una memoria universitaria en tensión, donde la violencia institucional, el feminicidio y la censura se inscriben como grietas en la materia.
El visitante recorre las texturas del monumento no como espectador distante, sino como testigo de un proceso de reapropiación simbólica. Las consignas proyectadas —“Nos están matando”, “Edoméx feminicida”, “Callar también es violencia”— no son actos de vandalismo, sino poéticas de la resistencia. En la virtualidad, las huellas se multiplican: cada intervención física deviene capa digital, testimonio de una comunidad que transforma el monumento en espejo de sus propias fracturas.
El silencio impuesto sobre la boca del expresidente, primero con una manta, después con una cruz de pintura, deviene símbolo del silencio social; pero también del grito que emerge al ser negado. Esta pieza invita a recorrer la historia del monumento no como un objeto muerto, sino como una escultura viva en disputa, donde la piedra habla a través de quienes la interpelan.

        </p>
      </article>
    </section>

    <!-- Columna derecha: carrusel vertical -->
    <aside class="rail">
      <div class="vcarousel">
        <button class="vc-btn" id="vcPrev">▲</button>
        <div class="vc-viewport" id="vcViewport">
          <div class="vc-track" id="vcTrack">
            <!-- Se llena por JS o deja <img> estáticos si prefieres -->
          </div>
        </div>
        <button class="vc-btn" id="vcNext">▼</button>
      </div>
    </aside>
  </div>
</div>

</div>


<!-- Overlay de imagen -->
<div class="overlay" id="imgOverlay" aria-modal="true" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.85); z-index:10003; display:grid; place-items:center;">
  <figure class="imgbox" style="position:relative; max-width:min(90vw,1200px); max-height:85vh; background:rgba(0,0,0,.9); padding:12px; border-radius:10px; overflow:hidden;">
    <button class="close-button" id="imgClose" style="position:absolute; top:8px; right:14px; font-size:20px; cursor:pointer; font-weight:bold;">✖</button>
    <img id="imgFull" alt="" style="display:block; max-width:100%; max-height:calc(85vh - 56px); margin:0 auto;">
    <figcaption id="imgNote" style="margin-top:8px; font-size:.9rem; line-height:1.3; color:#ddd; text-align:center;"></figcaption>
  </figure>
</div>




    
    <button id="help-button">Ayuda</button>
    <div id="help-overlay">
      <img src="ayuda.png" alt="Ayuda">
      <button id="close-help">Cerrar</button>
    </div>


    <a-scene loading-screen="enabled: false">

       <!-- Assets: Modelo GLB -->
      <a-assets>

       

        <a-asset-item id="sala3D" src="cabeza_con_piso.glb"></a-asset-item>
        <!-- Lista de assets extraídos del GLB -->
        <img id="mi-textura-360" src="paisaje1.jpg">
  


       
      </a-assets>
      
        
     
     <a-sky src="#mi-textura-360"></a-sky>

      <!-- Modelo de sala -->
<a-gltf-model id="sala" 
src="#sala3D" position="-4.58617 -2.5 18.23759" 
rotation="0 -49.58720533739223 0" 
auto-info-from-textures="" gltf-model="cabeza1.glb">
      </a-gltf-model>

      <!-- Ejemplos de im\xC3\xA1genes con informaci\xC3\xB3n -->
      <!--<a-image id="img1"  src="#painting1" position="-0.48 1.6 -1.05" scale="4.8 3 0" >-->
        
         <a-entity rotation="-90 0 0"
          geometry="primitive: plane; height: 20000; width: 20000" 
          position="0 -2.7 0" material="repeat: 1000 1000; color: #020202; roughness: 1">
                
      </a-entity>


      <!--Camara con joystick visible -->
      <a-entity  id="camera" camera look-controls position="-5 1.6 30"  
      wasd-controls joystick="enabled: true; left: true; right: true; up: true; down: true" 
      joystick-controls>

       <!-- Dentro de <a-entity id="camera"> -->
<a-cursor id="cursor"
          fuse="true"
          fuseTimeout="1500"
          raycaster="objects: .info-target"
          position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015"
          material="color: white; shader: flat">
  <a-ring id="cursorProgress"
          position="0 0 -0.001"
          radius-inner="0.017"
          radius-outer="0.021"
          material="shader: flat; depthTest: false; transparent: true; opacity: 1; color: #21FF00"
          theta-length="0"
          visible="false"></a-ring>
</a-cursor>

      </a-entity>

<!-- Activar joystick virtual -->
      <a-entity joystick></a-entity>

      
  
      <!-- Luces   -->
      
      <a-entity light="color: white; decay: 1.22; intensity: 50; penumbra: 1; type: spot" position="-26.30043 19.69294 -0.70704" rotation="-17.041483700576077 -90.15548202163016 90.78917334304487"></a-entity>
<a-entity light="color: white; decay: 1.47; intensity: 50; penumbra: 1; type: spot" position="8.34568 11.56663 0.74216" rotation="-39.76040619310348 0 90.89173278837328"></a-entity>      <a-entity light="angle: 180; color: white; decay: 1.45; intensity: 50; penumbra: 1; type: spot" position="19.74482 3.44844 -4.2623" rotation="36.53465380651694 -83.58422906927476 87.66483448619648"></a-entity>
<a-entity light="angle: 180; color: white; decay: 1.45; intensity: 50; penumbra: 1; type: spot" position="2.03963 6.12451 -12.25569" rotation="36.53465380651694 -83.58422906927476 87.66483448619648"></a-entity>      <a-entity light="angle: 30; color: white; decay: 2.1; intensity: 50; penumbra: 0.6; type: spot" position="-14.89289 10.65334 -39.58065" rotation="-35.33086947894708 90 -65.63116951664554"></a-entity>
<a-entity light="angle: 180; color: white; decay: 1.45; intensity: 50; penumbra: 1; type: spot" position="4.57455 2.01389 -1.26442" rotation="59.75777915875947 -165.97727888247255 -74.93256636279932"></a-entity>      <a-entity light="color: white; decay: 2.23; intensity: 50; penumbra: 0.6; type: spot" position="-14.35773 5.19396 -1.8294" rotation="-10.174584525933158 90.00021045914971 -64.44514688072474"></a-entity>
     
     
   

    <!-- Planos Referencia de Pancartas  

    <a-entity id="01" class="plano-info"
          data-template="tpl-01"
          geometry="primitive: plane"
          position="-21.427 1.655 -2.261"
          rotation="0 90 0" scale="8.76 2 1"
          visible="false"></a-entity> -->

 

    </a-scene>
   
  <script>
// Loader robusto
const pantalla = document.getElementById('pantalla-carga');
const escena   = document.querySelector('a-scene');
const assets   = document.querySelector('a-assets');
const hide = () => pantalla && (pantalla.style.display = 'none');
window.addEventListener('load', hide);
if (assets) { assets.addEventListener('loaded', hide); if (assets.hasLoaded) hide(); }
if (escena) { escena.addEventListener('loaded', hide); escena.addEventListener('renderstart', hide); if (escena.hasLoaded) hide(); }
setTimeout(hide, 8000);

// Overlay "Info"
function abrirInfo(){ document.getElementById('infoOverlay').style.display='block'; }
function cerrarInfo(){ document.getElementById('infoOverlay').style.display='none'; }

// Overlay por planos
function cerrarOverlayPlano(){
  const overlay = document.getElementById('overlayPlano');
  const cont = document.getElementById('textoPlano');
  overlay.style.display='none';
  cont.querySelectorAll('video,audio').forEach(m=>{ m.pause(); m.currentTime=0; });
}

(function(){
  const overlay = document.getElementById('overlayPlano');
  const texto   = document.getElementById('textoPlano');
  const planos  = document.querySelectorAll('.plano-info');
  const cursor  = document.getElementById('cursor');
  const progress= document.getElementById('cursorProgress');
  if(!overlay||!texto||!cursor||!progress){ console.error('Faltan nodos'); return; }

  // objetivos del raycaster
  planos.forEach(p=>p.classList.add('info-target'));
  if (cursor.components && cursor.components.raycaster) cursor.components.raycaster.refreshObjects();

  const FUSE_MS = parseInt(cursor.getAttribute('fuseTimeout')||3000,10);
  let rafId=null, startTs=0, activo=false;

  function resetProgress(){
    activo=false; startTs=0;
    if(rafId){ cancelAnimationFrame(rafId); rafId=null; }
    progress.setAttribute('theta-length', 0);
    progress.setAttribute('visible','false');
  }

  function animar(){
    if (!activo) return;
    const ratio = Math.min((performance.now()-startTs)/FUSE_MS, 1);
    progress.setAttribute('theta-length', 360 * ratio);
    const r = Math.floor(255*ratio), g = Math.floor(255*(1-ratio));
    progress.setAttribute('material','color', `rgb(${r},${g},0)`);
    if (ratio < 1) rafId = requestAnimationFrame(animar);
  }

  // <<< listeners correctos >>>
  planos.forEach(plano=>{
    plano.addEventListener('mouseenter', ()=>{
      activo = true; startTs = performance.now();
      progress.setAttribute('visible','true');
      progress.setAttribute('theta-length', 0);
      progress.setAttribute('material','color','rgb(0,255,0)');
      rafId = requestAnimationFrame(animar);
    });

    plano.addEventListener('mouseleave', resetProgress);

    plano.addEventListener('click', ()=>{
      const tplId = plano.getAttribute('data-template');
      texto.innerHTML='';
      if (tplId){
        const tpl=document.getElementById(tplId);
        if (tpl && tpl.content) texto.appendChild(tpl.content.cloneNode(true));
        else texto.textContent = plano.getAttribute('data-info') || 'Sin información';
      } else {
        texto.textContent = plano.getAttribute('data-info') || 'Sin información';
      }
      overlay.style.display='block';
      resetProgress();
    });
  });

  cursor.addEventListener('mouseleave', resetProgress);
})();

/* ===== Carrusel vertical: poblar y navegar ===== */
// ===== Datos del carrusel (agrega tus notas) =====
const VC_IMGS = [
  {src:'assets/img/CALM/CALM_01.jpg', note:'Manta sobre la boca, 2020. Foto: autor.'},
  {src:'assets/img/CALM/CALM_02.jpg', note:'Vista lateral con pintura negra, 2025.'},
  {src:'assets/img/CALM/CALM_03.png', note:'Detalle de cantera y fisuras.'},
  {src:'assets/img/CALM/CALM_04.png', note:'Intervención con consignas feministas.'},
  {src:'assets/img/CALM/CALM_05.png', note:'Intervención con consignas feministas.'},
  {src:'assets/img/CALM/CALM_06.png', note:'Intervención con consignas feministas.'},
  {src:'assets/img/CALM/CALM_07.png', note:'Intervención con consignas feministas.'},
  {src:'assets/img/CALM/CALM_08.png', note:'Intervención con consignas feministas.'}
];

// ===== Render del carrusel =====
(function initVerticalCarousel(){
  const track = document.getElementById('vcTrack');
  if(track){
    track.innerHTML = VC_IMGS.map((it,i) =>
      `<img class="vc-item" src="${it.src}" alt="Imagen ${i+1}" data-note="${it.note||''}">`
    ).join('');
  }
  const vp = document.getElementById('vcViewport');
  const up = document.getElementById('vcPrev');
  const dn = document.getElementById('vcNext');
  if(vp && up && dn){
    const step = () => Math.max(220, vp.clientHeight * 0.9);
    up.addEventListener('click', () => vp.scrollBy({top:-step(), behavior:'smooth'}));
    dn.addEventListener('click', () => vp.scrollBy({top: step(), behavior:'smooth'}));
  }

  // Click en miniatura => overlay grande
  track.addEventListener('click', (e)=>{
    const img = e.target.closest('.vc-item');
    if(!img) return;
    abrirImagenGrande(img.src, img.dataset.note || img.alt || '');
  });
})();

// ===== Overlay de imagen grande =====
function abrirImagenGrande(src, note){
  const ov  = document.getElementById('imgOverlay');
  const big = document.getElementById('imgFull');
  const cap = document.getElementById('imgNote');
  if(!ov||!big||!cap) return;
  big.src = src;
  cap.textContent = note;
  ov.style.display = 'grid';
}

// Cerrar overlay por botón o clic fuera
(function(){
  const ov = document.getElementById('imgOverlay');
  const btn= document.getElementById('imgClose');
  if(btn) btn.addEventListener('click', ()=> ov.style.display='none');
  if(ov) ov.addEventListener('click', (e)=>{ if(e.target.id==='imgOverlay') ov.style.display='none'; });
})();

// Asegura que al abrir "Info" todo quede en posición inicial
function abrirInfo(){
  const ovl = document.getElementById('infoOverlay');
  if(ovl) ovl.style.display='block';
  const vp = document.getElementById('vcViewport');
  if(vp) vp.scrollTop = 0;
}
</script>



  </body>
</html>